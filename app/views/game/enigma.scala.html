@(enigma: models.Enigma, clues: List[models.Clue])

@import helpers._
@import models._
@import _root_.global._

@createCheckAnswerButton(answer: Answer) = {
	@if(answer.isInstanceOf[TextAnswer]) {
		<button class="btn" id="check-answer" data-type-answer="text">Vérifiez votre réponse</button>
	} else {
		<button class="btn" id="check-answer" data-type-answer="geolocated">Vérifiez votre position</button>
	}
}

@global.main() {
	<div class="row-fluid">
		<div class="span12">
			<blockquote>
				@enigma.getDescription()
			</blockquote>

			<div class="form-horizontal" data-check-action="@routes.GameController.checkAnswer()" id="form-check-answer">
				@if(enigma.getAnswer().isInstanceOf[models.TextAnswer]) {
					<div class="control-group">
						<label class="control-label" for="answer-text">Votre réponse</label>
						<div class="controls">
							<input class="span12" type="text" id="answer-text" name="text" value="" />
						</div>
					</div>
				} else {
					<blockquote>Vous devez vous rendre à l'emplacement que vous indique l'énigme. Une fois que vous pensez être au bon endroit, vérifiez votre réponse !</blockquote>
				}
				
				<div class="actions">
					@createCheckAnswerButton(enigma.getAnswer())
				</div>

				<ol data-role="listview" id="clues-list" class="list-view" data-number="@enigma.getClues().size()">
					@for(clue <- clues) {
						<li class="clue">@clue.getDescription()</li>
					}
				</ol>

				<div id="template-clue" class="hide">
					<li class="clue">__description__</li>
				</div>

				@if(clues.isEmpty()) {
					<p id="no-clues">Vous n'avez pas affiché d'indices pour le moment</p>
				}

				@if(clues.size() < enigma.getClues().size()) {
					<form method="POST" action="@routes.GameController.nextClue()" id="next-clue">
						@defining(AuthenticationTokenGenerator.generate()) { token =>
							<input type="hidden" name="token" value="@token" />
						}
						<button type="submit" class="btn">Afficher un nouvel indice</button>
					</form>
				}

				<div class="actions">
					<form method="POST" action="@routes.GameController.skipEnigma()" id="skip-enigma">
						@defining(AuthenticationTokenGenerator.generate()) { token =>
							<input type="hidden" name="token" value="@token" />
						}
						<button type="submit" class="btn btn-danger">Passer</button>
					</form>
					<p id="info-pass" class="danger">Vous n'arrivez pas à résoudre l'énigme ? Passez...</p>
				</div>
			</div>


		</div>
	</div>
}